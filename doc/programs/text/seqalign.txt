
                           SEQALIGN documentation
                                      
   

CONTENTS

   1.0 SUMMARY 
   2.0 INPUTS & OUTPUTS 
   3.0 INPUT FILE FORMAT 
   4.0 OUTPUT FILE FORMAT 
   5.0 DATA FILES 
   6.0 USAGE 
   7.0 KNOWN BUGS & WARNINGS 
   8.0 NOTES 
   9.0 DESCRIPTION 
   10.0 ALGORITHM 
   11.0 RELATED APPLICATIONS 
   12.0 DIAGNOSTIC ERROR MESSAGES 
   13.0 AUTHORS 
   14.0 REFERENCES 

1.0 SUMMARY

   Reads a DAF file (domain alignment file) and a DHF (domain hits file)
   and writes a DAF file extended with the hits.

2.0 INPUTS & OUTPUTS

   SEQALIGN reads a directory of "seed" alignments and a directory of
   sets of protein sequences and writes a directory of "extended"
   alignments. An extended alignment is a seed alignment that is extended
   with sequences from the appropriate sequence set. The sets directory
   must contain a sequence set for each seed alignment directory and the
   files must have the same base name. For example, sequences from
   "family.sets" are used to extend the seed alignment "family.aln".
   Typically, the inputs are (i) DAF files (domain alignment files)
   containing structure-based sequence alignments and (ii) DHF files
   (domain hits files) containing sequence relatives (of unknown
   structure) of these alignments, and the output are DAF files
   containing the extended alignments.
   The base names of the output alignments are the same as the input
   alignments. The paths for input and output files are specified by the
   user and the file extensions are set in the ACD file.

3.0 INPUT FILE FORMAT

   The format of the domain alignment file is described in DOMAINALIGN
   documentation.
   If other alignment files are used as input, all of the common file
   formats are supported.
   The format of the domain hits file is described in SEQSEARCH
   documentation.
   If other sequence sets are used as input, all of the common file
   formats are supported.

4.0 OUTPUT FILE FORMAT

   The format of the domain alignment file is described in DOMAINALIGN
   documentation. Note however that the file will never contain 'Number'
   or 'Post_similar' records. Futhermore, the code before each sequence
   is of the form Acc_Start_End (where domain hits files were used as
   input sequences) or Acc_n (where other sequences were used as input),
   where 'Acc' is the accession number of the sequence, 'Start' and 'End'
   are the start and end point of the sequence in the full length
   sequence respectively, and 'n' is a sequential count of the sequence
   in the alignment.

5.0 DATA FILES

   SEQALIGN does not use a data file.

6.0 USAGE

  6.1 COMMAND LINE ARGUMENTS

   Standard (Mandatory) qualifiers Allowed values Default
   -mode This option specifies the mode of SEQSEARCH operation. SEQSEARCH
   takes as input a directory of either i. single sequences, ii. set of
   sequences (unaligned or aligned, but typically aligned sequences
   within a domain alignment file)). The user has to specify which.
   1 (Single sequences)
   2 (Multiple sequences (e.g. sequence set or alignment))
   1
   [-inseqs]
   (Parameter 1) This option specifies the location of sequences, e.g.
   DAF files (domain alignment files) (input). SEQSEARCH takes as input a
   database of either i. single sequences, ii. sets of unaligned
   sequences or iii. sets of aligned sequences, e.g. a domain alignment
   file. A 'domain alignment file' contains a sequence alignment of
   domains belonging to the same SCOP or CATH family. The file is in
   clustal format annotated with domain family classification
   information. The files generated by using SCOPALIGN will contain a
   structure-based sequence alignment of domains of known structure only.
   Such alignments can be extended with sequence relatives (of unknown
   structure) by using SEQALIGN. Directory with files ./
   [-dhfin]
   (Parameter 2) This option specifies the location of DHF files (domain
   hits files) (input). A 'domain hits file' contains database hits
   (sequences) with domain classification information, in the DHF format
   (FASTA or EMBL-like). The hits are relatives to a SCOP or CATH family
   and are found from a search of a sequence database. Files containing
   hits retrieved by PSIBLAST are generated by using SEQSEARCH. Directory
   ./
   -amode This option specifies which alignment algorithm to use.
   1 (CLUSTALW)
   2 (TCOFFEE (not yet implemented))
   1
   [-dafout]
   (Parameter 3) This option specifies the location of DAF files (domain
   alignment files) (output). A 'domain alignment file' contains a
   sequence alignment of domains belonging to the same SCOP or CATH
   family. The file is in clustal format annotated with domain family
   classification information. The files generated by using SCOPALIGN
   will contain a structure-based sequence alignment of domains of known
   structure only. Such alignments can be extended with sequence
   relatives (of unknown structure) by using SEQALIGN. Directory ./
   -logf This option specifies the name of log file for the build. The
   log file contains messages about any errors arising while SEQALIGN
   ran. Output file seqalign.log
   Additional (Optional) qualifiers Allowed values Default
   (none)
   Advanced (Unprompted) qualifiers Allowed values Default
   (none)

  6.2 EXAMPLE SESSION

   An example of interactive use of SEQALIGN is shown below.


Unix % seqalign
Reads a DAF file (domain alignment file) and a DHF (domain hits file) and
writes a DAF file extended with the hits.
Location of DAF files (domain alignment files) (input) [./]: /test_data
Location of DHF files (domain hits files) (input) [./]: /test_data
Alignment algorithm option
         1 : STAMP
         2 : TCOFFEE (not yet implemented)
Select number [1]: 1
Location of DAF files (domain alignment files) (output) [./]: /test_data/seqali
gn
Name of log file for the build [seqalign.log]: /test_data/seqalign/seqalign.log
Processing /test_data/54894.salign

clustalw -type=protein -profile1=./seqalign-1093871933.5448.aln -sequences -pro
file2=./seqalign-1093871933.5448.seqs -MATRIX=BLOSUM -GAPOPEN=10 -GAPEXT=0.5 -o
utfile=./seqalign-1093871933.5448.out




 CLUSTAL W (1.83) Multiple Sequence Alignments



Sequence type explicitly set to Protein
Sequence format is Pearson
No. of seqs=2
Sequences assumed to be PROTEIN
Sequence 1: d4at1b1_0        94 aa
Sequence 2: d4at1d1_1        94 aa
Sequence format is Pearson
No. of seqs in profile=40
Total no. of seqs     =42
Sequences assumed to be PROTEIN
Sequence 3: Q9YBD5_11_105        95 aa
Sequence 4: Q9UX07_12_104        93 aa
Sequence 5: Q9KP65_9_100         92 aa
Sequence 6: Q9K1K9_8_99          92 aa
Sequence 7: Q9JWY6_8_99          92 aa
Sequence 8: Q9HKM3_7_99          93 aa
Sequence 9: Q9HHN3_9_101         93 aa

< Further clustal output omitted for clarity >

Unix %

   SEQALIGN read all domain alignment files with the file extension
   .salign (specified in ACD) from the directory /test_data, and extended
   these alignments using the sequences from domain hits files with file
   extension .hits (specified in ACD) in the directory /test_data.
   Extended domain alignment files (file extension .ealign specified in
   ACD) were written to /test_data/seqalign.
   The following command line would achieve the same result.


seqalign test_data test_data test_data/seqalign -mode 1  -amode 1 -logf test_da
ta/seqalign/seqalign.log

7.0 KNOWN BUGS & WARNINGS

   None.

8.0 NOTES

   1. Use of CLUSTAL
   clustalw must be installed on the system that is running SEQSEARCH.
   When running SEQSEARCH at the HGMP it is essential that the command
   'use clustal' (which runs the script /packages/menu/USE/clustal) is
   given before it is run.
   2. Empty domain hits file (input)
   If just a single or no sequences are given in the domain hits file
   then no extended alignment will be generated.

  8.1 GLOSSARY OF FILE TYPES

   FILE TYPE FORMAT DESCRIPTION CREATED BY SEE ALSO
   Domain hits file DHF format (FASTA-like format with domain
   classification information). Database hits (sequences) with domain
   classification information. The hits are relatives to a SCOP or CATH
   family and are found from a search of a sequence database. SEQSEARCH
   (hits retrieved by PSIBLAST) N.A.
   Domain alignment file DAF format (CLUSTAL-like format with domain
   classification information). Contains a sequence alignment of domains
   belonging to the same SCOP or CATH family. The file is annotated with
   domain family classification information. DOMAINALIGN (structure-based
   sequence alignment of domains of known structure). DOMAINALIGN
   alignments can be extended with sequence relatives (of unknown
   structure) to the family in question by using SEQALIGN.

9.0 DESCRIPTION

   The generation of sequence alignments for large datasets such as SCOP
   or CATH potentially requires a lot of time for preparation of
   datasets, running jobs and so on, in addition to the compute time
   required for the alignments themselves. SEQALIGN will generate an
   extended alignment for each seed alignment in a directory for which a
   file of sequences is available, by using CLUSTALW. Sequences are added
   one by one to the appropriate seed alignment.

10.0 ALGORITHM

   None.

11.0 RELATED APPLICATIONS

   APPLICATION DESCRIPTION
   DOMAINALIGN Generates structure-based sequence alignments for nodes in
   a DCF file (domain classification file).
   SEQSEARCH Generate DHF files (domain hits files) of database hits
   (sequences) from a DAF file (domain alignment file) or other sequences
   by using PSI-BLAST.
   SEQWORDS Generates DHF files (domain hits files) of database hits
   (sequences) for nodes in a DCF file (domain classification file) by
   keyword search of UniProt.
   SEQALIGN Reads a DAF file (domain alignment file) and a DHF (domain
   hits file) and writes a DAF file extended with the hits.

12.0 DIAGNOSTIC ERROR MESSAGES

   The log file might contain the following messages:
   Could not open seed sequence file my.file (file read error on input
   sequence alignment or sequence file)
   Empty alignment in my.file (input alignment was empty.)
   Empty singlet sequence for my.file (singlet sequence file was empty.)
   Could not open domain hits file my.file (file read error on input
   sequence file.)
   Not enough sequences found in domain hits file (insufficient sequences
   (i.e. < 2) in input sequence file.)

13.0 AUTHORS

   Ranjeeva Ranasinghe (rranasin@rfcgr.mrc.ac.uk)
   Jon Ison (jison@rfcgr.mrc.ac.uk)
   MRC Rosalind Franklin Centre for Genomics Research Wellcome Trust
   Genome Campus, Hinxton, Cambridge, CB10 1SB, UK

14.0 REFERENCES

   Please cite the authors and EMBOSS.
   Rice P, Longden I and Bleasby A (2000) "EMBOSS - The European
   Molecular Biology Open Software Suite" Trends in Genetics, 15:276-278.
   
   See also http://emboss.sourceforge.net/

  14.1 Other useful references
