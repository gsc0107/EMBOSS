
   [an error occurred while processing this directive]

SEQALIGN documentation

   [an error occurred while processing this directive]

CONTENTS

   1.0 SUMMARY 
   2.0 INPUTS & OUTPUTS 
   3.0 INPUT FILE FORMAT 
   4.0 OUTPUT FILE FORMAT 
   5.0 DATA FILES 
   6.0 USAGE 
   7.0 KNOWN BUGS & WARNINGS 
   8.0 NOTES 
   9.0 DESCRIPTION 
   10.0 ALGORITHM 
   11.0 RELATED APPLICATIONS 
   12.0 DIAGNOSTIC ERROR MESSAGES 
   13.0 AUTHORS 
   14.0 REFERENCES 

1.0 SUMMARY

   [an error occurred while processing this directive]

2.0 INPUTS & OUTPUTS

   SEQALIGN reads a directory of "seed" alignments and a directory of
   sets of protein sequences and writes a directory of "extended"
   alignments. An extended alignment is a seed alignment that is extended
   with sequences from the appropriate sequence set. The sets directory
   must contain a sequence set for each seed alignment directory and the
   files must have the same base name. For example, sequences from
   "family.sets" are used to extend the seed alignment "family.aln".
   Typically, the inputs are (i) DAF files (domain alignment files)
   containing structure-based sequence alignments and (ii) DHF files
   (domain hits files) containing sequence relatives (of unknown
   structure) of these alignments, and the output are DAF files
   containing the extended alignments.
   The base names of the output alignments are the same as the input
   alignments. The paths for input and output files are specified by the
   user and the file extensions are set in the ACD file.

3.0 INPUT FILE FORMAT

   The format of the domain alignment file is described in DOMAINALIGN
   documentation.
   If other alignment files are used as input, all of the common file
   formats are supported.
   The format of the domain hits file is described in SEQSEARCH
   documentation.
   If other sequence sets are used as input, all of the common file
   formats are supported.

4.0 OUTPUT FILE FORMAT

   The format of the domain alignment file is described in DOMAINALIGN
   documentation. Note however that the file will never contain 'Number'
   or 'Post_similar' records. Futhermore, the code before each sequence
   is of the form Acc_Start_End (where domain hits files were used as
   input sequences) or Acc_n (where other sequences were used as input),
   where 'Acc' is the accession number of the sequence, 'Start' and 'End'
   are the start and end point of the sequence in the full length
   sequence respectively, and 'n' is a sequential count of the sequence
   in the alignment.

  Output files for usage example

  File: 54894.daf

# TY   SCOP
# XX
# CL   Alpha and beta proteins (a+b)
# XX
# FO   Ferredoxin-like
# XX
# SF   Aspartate carbamoyltransferase, Regulatory-chain, N-terminal domain
# XX
# FA   Aspartate carbamoyltransferase, Regulatory-chain, N-terminal domain
# XX
# SI   54894
# XX
Q9YBD5_11_105             0 VRKIRSGVVIDHIPPGRAFTMLKALGLLPPRGYRWRIAVVINAESSKLGRK
DILKIEGYK 0
Q9YBD4_11_105             0 VRKIRSGVVIDHIPPGRAFTMLKALGLLPPRGYRWRIAVVINAESSKLGRK
DILKIEGYK 0
Q9UX07_12_104             0 VSKIRNGTVIDHIPAGRALAVLRILGIRGSEGY--RVALVMNVESKKIGRK
DIVKIEDRV 0
Q9KP65_9_100              0 VEAIKNGTVIDHIPAKVGIKVLKLFDMHN---SAQRVTIGLNLPSSALGSK
DLLKIENVF 0

Q9YBD5_11_105             0 PRQRDLEVLGIIAPGATFNVIEDYKVVEKVKLKLP 0
Q9YBD4_11_105             0 PRQRDLEVLGIIAPGATFNVIEDYKVVEKVKLKLP 0
Q9UX07_12_104             0 IDEKEASLITLIAPSATINIIRDYVVTEKRHLEVP 0
Q9KP65_9_100              0 ISEAQANKLALYAPHATVNQIENYEVVKKLALQLP 0

  File: 55074.daf

# TY   SCOP
# XX
# CL   Alpha and beta proteins (a+b)
# XX
# FO   Ferredoxin-like
# XX
# SF   Adenylyl and guanylyl cyclase catalytic domain
# XX
# FA   Adenylyl and guanylyl cyclase catalytic domain
# XX
# SI   55074
# XX
Q9WVI4_513_667            0 --------RKFDDVTMLFSDIVGFTAICAQCTP--MQVISMLNELYTRFDH
QCG---FLD 0
Q9WVI5_513_667            0 --------RKFDDVTMLFSDIVGFTAICAQCTP--MQVISMLNELYTRFDH
QCG---FLD 0
Q9ERL9_475_626            0 --------KKFSEVTMLFSDIVGFTAICSQCSP--LQVITMLNALYTRFDQ
QCG---ELD 0
Q9DGG6_369_560            0 IIFRPFKMQQIEQVSILFADIVGFTKMSANKSA--HALVGLLNDLFGRFDR
LCE---DTK 0
Q9DGG6_1032_1200          0 ------YSKNHDSGGVIFASIVNFSEFYEENYEGGKECYRVLNELIGDFDE
LLSKPHYSS 0

Q9WVI4_513_667            0 IYKVETIGDAYCVASGLHRKSL-------CHAKPIALMALKMMELSEEVLT
PDGRP-IQM 0
Q9WVI5_513_667            0 IYKVETIGDAYCVASGLHRKSL-------CHAKPIALMALKMMELSEEVLT
PDGRP-IQM 0
Q9ERL9_475_626            0 VYKVETIGDAYCVAGGLHRESD-------THAVQIALMALKMMELSNEVMS
PHGEP-IKM 0
Q9DGG6_369_560            0 CEKISTLGDCYYCVAGCPEPRA-------DHAYCCIEMGLGMIKAIEQFCQ
EKKEM-VNM 0
Q9DGG6_1032_1200          0 IEKIKTIGATYMAASGLNTSQCQDSNHPHGHLQTLFEFAKEMMRVVDDFNN
NMLWFNFKL 0

Q9WVI4_513_667            0 RIGIHSGSVLAGVVGVRMPRYCLFGNNVTLASKFESGSHPRRINISPTTYQ
LLKRE---- 0
Q9WVI5_513_667            0 RIGIHSGSVLAGVVGVRMPRYCLFGNNVTLASKFESGSHPRRINISPTTYQ
LLKRE---- 0
Q9ERL9_475_626            0 RIGLHSGSVFAGVVGVKMPRYCLFGNNVTLANKFESCSVPRKINVSPTTYR
LL------- 0
Q9DGG6_369_560            0 RVGVHTGTVLCGILGMRRFKFDVWSNDVNLANLMEQLGVAGKVHISEATAK
YLDDRYEME 0
Q9DGG6_1032_1200          0 RIGFNHGPLTAGVIGTTKLLYDIWGDTVNIASRMDTIGVECRIQVSEETYR
ILSK----- 0

Q9WVI4_513_667            0 ------------------------- 0
Q9WVI5_513_667            0 ------------------------- 0
Q9ERL9_475_626            0 ------------------------- 0
Q9DGG6_369_560            0 DGKVTERVGQSAVADQLKGLKTYLI 0
Q9DGG6_1032_1200          0 ------------------------- 0

  File: seqalign.log

//
/ebi/services/idata/pmr/hgmp/test/data/structure/54894.dhf
//
/ebi/services/idata/pmr/hgmp/test/data/structure/55074.dhf

5.0 DATA FILES

   SEQALIGN does not use a data file.

6.0 USAGE

  6.1 COMMAND LINE ARGUMENTS

   Standard (Mandatory) qualifiers (* if not always prompted):
   -mode               menu       This option specifies the mode of SEQALIGN
                                  operation. SEQALIGN takes as input a
                                  directory of either i. single sequences, ii.
                                  set of sequences (unaligned or aligned, but
                                  typically aligned sequences within a domain
                                  alignment file)). The user has to specify
                                  which.
*  -dhfinpath          dirlist    This option specifies the location of
                                  sequences, e.g. DHF files (domain hits
                                  files) (input). SEQALIGN takes as input a
                                  database of either i. single sequences, ii.
                                  sets of unaligned sequences or iii. sets of
                                  aligned sequences, e.g. a domain alignment
                                  file. A 'domain alignment file' contains a
                                  sequence alignment of domains belonging to
                                  the same SCOP or CATH family. The file is in
                                  clustal format annotated with domain family
                                  classification information. The files
                                  generated by using SCOPALIGN will contain a
                                  structure-based sequence alignment of
                                  domains of known structure only. Such
                                  alignments can be extended with sequence
                                  relatives (of unknown structure) by using
                                  SEQALIGN.
*  -dafinpath          dirlist    This option specifies the location of
                                  sequences, e.g. DAF files (domain alignment
                                  files) (input). SEQALIGN takes as input a
                                  database of either i. single sequences, ii.
                                  sets of unaligned sequences or iii. sets of
                                  aligned sequences, e.g. a domain alignment
                                  file. A 'domain alignment file' contains a
                                  sequence alignment of domains belonging to
                                  the same SCOP or CATH family. The file is in
                                  clustal format annotated with domain family
                                  classification information. The files
                                  generated by using SCOPALIGN will contain a
                                  structure-based sequence alignment of
                                  domains of known structure only. Such
                                  alignments can be extended with sequence
                                  relatives (of unknown structure) by using
                                  SEQALIGN.
  [-dhfindir]          directory  This option specifies the location of DHF
                                  files (domain hits files) (input). A 'domain
                                  hits file' contains database hits
                                  (sequences) with domain classification
                                  information, in the DHF format (FASTA or
                                  EMBL-like). The hits are relatives to a SCOP
                                  or CATH family and are found from a search
                                  of a sequence database. Files containing
                                  hits retrieved by PSIBLAST are generated by
                                  using SEQSEARCH.
   -amode              menu       This option specifies which alignment
                                  algorithm to use.
  [-dafoutdir]         outdir     This option specifies the location of DAF
                                  files (domain alignment files) (output). A
                                  'domain alignment file' contains a sequence
                                  alignment of domains belonging to the same
                                  SCOP or CATH family. The file is in clustal
                                  format annotated with domain family
                                  classification information. The files
                                  generated by using SCOPALIGN will contain a
                                  structure-based sequence alignment of
                                  domains of known structure only. Such
                                  alignments can be extended with sequence
                                  relatives (of unknown structure) by using
                                  SEQALIGN.
   -logfile            outfile    This option specifies the name of log file
                                  for the build. The log file contains
                                  messages about any errors arising while
                                  SEQALIGN ran.

   Additional (Optional) qualifiers:
   -forcetype          boolean    This option specifies whether to force
                                  minimal domain classification data to be
                                  written to the output file in cases where
                                  singlet sequences were given as input file
                                  and no classification data was available

   Advanced (Unprompted) qualifiers: (none)
   Associated qualifiers:

   "-logfile" associated qualifiers
   -odirectory         string     Output directory

   General qualifiers:
   -auto               boolean    Turn off prompts
   -stdout             boolean    Write standard output
   -filter             boolean    Read standard input, write standard output
   -options            boolean    Prompt for standard and additional values
   -debug              boolean    Write debug output to program.dbg
   -verbose            boolean    Report some/full command line options
   -help               boolean    Report command line options. More
                                  information on associated and general
                                  qualifiers can be found with -help -verbose
   -warning            boolean    Report warnings
   -error              boolean    Report errors
   -fatal              boolean    Report fatal errors
   -die                boolean    Report deaths


   Standard (Mandatory) qualifiers Allowed values Default
   -mode This option specifies the mode of SEQALIGN operation. SEQALIGN
   takes as input a directory of either i. single sequences, ii. set of
   sequences (unaligned or aligned, but typically aligned sequences
   within a domain alignment file)). The user has to specify which.
   1 (Single sequences)
   2 (Multiple sequences (e.g. sequence set or alignment))
   1
   -dhfinpath This option specifies the location of sequences, e.g. DHF
   files (domain hits files) (input). SEQALIGN takes as input a database
   of either i. single sequences, ii. sets of unaligned sequences or iii.
   sets of aligned sequences, e.g. a domain alignment file. A 'domain
   alignment file' contains a sequence alignment of domains belonging to
   the same SCOP or CATH family. The file is in clustal format annotated
   with domain family classification information. The files generated by
   using SCOPALIGN will contain a structure-based sequence alignment of
   domains of known structure only. Such alignments can be extended with
   sequence relatives (of unknown structure) by using SEQALIGN. Directory
   with files ./
   -dafinpath This option specifies the location of sequences, e.g. DAF
   files (domain alignment files) (input). SEQALIGN takes as input a
   database of either i. single sequences, ii. sets of unaligned
   sequences or iii. sets of aligned sequences, e.g. a domain alignment
   file. A 'domain alignment file' contains a sequence alignment of
   domains belonging to the same SCOP or CATH family. The file is in
   clustal format annotated with domain family classification
   information. The files generated by using SCOPALIGN will contain a
   structure-based sequence alignment of domains of known structure only.
   Such alignments can be extended with sequence relatives (of unknown
   structure) by using SEQALIGN. Directory with files ./
   [-dhfindir]
   (Parameter 1) This option specifies the location of DHF files (domain
   hits files) (input). A 'domain hits file' contains database hits
   (sequences) with domain classification information, in the DHF format
   (FASTA or EMBL-like). The hits are relatives to a SCOP or CATH family
   and are found from a search of a sequence database. Files containing
   hits retrieved by PSIBLAST are generated by using SEQSEARCH. Directory
   ./
   -amode This option specifies which alignment algorithm to use.
   1 (CLUSTALW)
   2 (TCOFFEE (not yet implemented))
   1
   [-dafoutdir]
   (Parameter 2) This option specifies the location of DAF files (domain
   alignment files) (output). A 'domain alignment file' contains a
   sequence alignment of domains belonging to the same SCOP or CATH
   family. The file is in clustal format annotated with domain family
   classification information. The files generated by using SCOPALIGN
   will contain a structure-based sequence alignment of domains of known
   structure only. Such alignments can be extended with sequence
   relatives (of unknown structure) by using SEQALIGN. Output directory
   ./
   -logfile This option specifies the name of log file for the build. The
   log file contains messages about any errors arising while SEQALIGN
   ran. Output file seqalign.log
   Additional (Optional) qualifiers Allowed values Default
   -forcetype This option specifies whether to force minimal domain
   classification data to be written to the output file in cases where
   singlet sequences were given as input file and no classification data
   was available Boolean value Yes/No No
   Advanced (Unprompted) qualifiers Allowed values Default
   (none)

  6.2 EXAMPLE SESSION

   An example of interactive use of SEQALIGN is shown below. Here is a
   sample session with seqalign


% seqalign 
Extend alignments (DAF file) with sequences (DHF file).
Input mode
         1 : Single sequences
         2 : Multiple sequences (e.g. sequence set or alignment)
Select mode of operation. [1]: 1
Location of sequences, e.g. DHF files (domain hits files) (input). [./]: struct
ure
Location of DHF files (domain hits files) (input). [./]: seqalign
Alignment algorithm option
         1 : CLUSTALW
         2 : TCOFFEE (not yet implemented)
Select number. [1]: 
Location of DAF files (domain alignment files) (output). [./]: 
Name of log file for the build. [seqalign.log]: 




 CLUSTAL W (1.83) Multiple Sequence Alignments



Sequence format is Pearson
Sequence 1: Q9YBD5_11_105       95 aa
Sequence 2: Q9YBD4_11_105       95 aa
Sequence 3: Q9UX07_12_104       93 aa
Sequence 4: Q9KP65_9_100        92 aa
Start of Pairwise alignments
Aligning...
Sequences (1:2) Aligned. Score:  100
Sequences (1:3) Aligned. Score:  51
Sequences (1:4) Aligned. Score:  41
Sequences (2:3) Aligned. Score:  51
Sequences (2:4) Aligned. Score:  41
Sequences (3:4) Aligned. Score:  43
Guide tree        file created:   [./seqalign-1119283021.25929.dnd]
Start of Multiple Alignment
There are 3 groups
Aligning...
Group 1: Sequences:   2      Score:1553
Group 2: Sequences:   3      Score:739
Group 3: Sequences:   4      Score:655
Alignment Score 1720
CLUSTAL-Alignment file created  [./seqalign-1119283021.25929.out]



 CLUSTAL W (1.83) Multiple Sequence Alignments



Sequence format is Pearson
Sequence 1: Q9WVI4_513_667        155 aa
Sequence 2: Q9WVI5_513_667        155 aa
Sequence 3: Q9ERL9_475_626        152 aa
Sequence 4: Q9DGG6_1032_1200      169 aa
Sequence 5: Q9DGG6_369_560        192 aa
Start of Pairwise alignments
Aligning...
Sequences (1:2) Aligned. Score:  100
Sequences (1:3) Aligned. Score:  78
Sequences (1:4) Aligned. Score:  24
Sequences (1:5) Aligned. Score:  30
Sequences (2:3) Aligned. Score:  78
Sequences (2:4) Aligned. Score:  24
Sequences (2:5) Aligned. Score:  30
Sequences (3:4) Aligned. Score:  25
Sequences (3:5) Aligned. Score:  31
Sequences (4:5) Aligned. Score:  23
Guide tree        file created:   [./seqalign-1119283021.25929.dnd]
Start of Multiple Alignment
There are 4 groups
Aligning...
Group 1: Sequences:   2      Score:2567
Group 2: Sequences:   3      Score:2490
Group 3: Sequences:   4      Score:1061
Group 4:                     Delayed
Sequence:4     Score:926
Alignment Score 4025
CLUSTAL-Alignment file created  [./seqalign-1119283021.25929.out]
Processing /ebi/services/idata/pmr/hgmp/test/data/structure/54894.dhf

clustalw -infile=./seqalign-1119283021.25929.seqs -align -MATRIX=BLOSUM -GAPOPE
N=10 -GAPEXT=0.5 -outfile=./seqalign-1119283021.25929.out

Processing /ebi/services/idata/pmr/hgmp/test/data/structure/55074.dhf

clustalw -infile=./seqalign-1119283021.25929.seqs -align -MATRIX=BLOSUM -GAPOPE
N=10 -GAPEXT=0.5 -outfile=./seqalign-1119283021.25929.out


   Go to the output files for this example

   SEQALIGN read all domain alignment files with the file extension
   .salign (specified in ACD) from the directory /test_data, and extended
   these alignments using the sequences from domain hits files with file
   extension .hits (specified in ACD) in the directory /test_data.
   Extended domain alignment files (file extension .ealign specified in
   ACD) were written to /test_data/seqalign.

7.0 KNOWN BUGS & WARNINGS

   None.

8.0 NOTES

   1. Use of CLUSTAL
   clustalw must be installed on the system that is running SEQSEARCH.
   When running SEQSEARCH at the HGMP it is essential that the command
   'use clustal' (which runs the script /packages/menu/USE/clustal) is
   given before it is run.
   2. Empty domain hits file (input)
   If just a single or no sequences are given in the domain hits file
   then no extended alignment will be generated.

  8.1 GLOSSARY OF FILE TYPES

   FILE TYPE FORMAT DESCRIPTION CREATED BY SEE ALSO
   Domain hits file DHF format (FASTA-like format with domain
   classification information). Database hits (sequences) with domain
   classification information. The hits are relatives to a SCOP or CATH
   family and are found from a search of a sequence database. SEQSEARCH
   (hits retrieved by PSIBLAST) N.A.
   Domain alignment file DAF format (CLUSTAL-like format with domain
   classification information). Contains a sequence alignment of domains
   belonging to the same SCOP or CATH family. The file is annotated with
   domain family classification information. DOMAINALIGN (structure-based
   sequence alignment of domains of known structure). DOMAINALIGN
   alignments can be extended with sequence relatives (of unknown
   structure) to the family in question by using SEQALIGN.

   None

9.0 DESCRIPTION

   The generation of sequence alignments for large datasets such as SCOP
   or CATH potentially requires a lot of time for preparation of
   datasets, running jobs and so on, in addition to the compute time
   required for the alignments themselves. SEQALIGN will generate an
   extended alignment for each seed alignment in a directory for which a
   file of sequences is available, by using CLUSTALW. Sequences are added
   one by one to the appropriate seed alignment.

10.0 ALGORITHM

   None.

11.0 RELATED APPLICATIONS

See also

   Program name                       Description
   contacts     Generate intra-chain CON files from CCF files
   domainalign  Generate alignments (DAF file) for nodes in a DCF file
   domainrep    Reorder DCF file to identify representative structures
   domainreso   Remove low resolution domains from a DCF file
   interface    Generate inter-chain CON files from CCF files
   libgen       Generate discriminating elements from alignments
   matgen3d     Generate a 3D-1D scoring matrix from CCF files
   psiphi       Phi and psi torsion angles from protein coordinates
   rocon        Generates a hits file from comparing two DHF files
   rocplot      Performs ROC analysis on hits files
   seqfraggle   Removes fragment sequences from DHF files
   seqsearch    Generate PSI-BLAST hits (DHF file) from a DAF file
   seqsort      Remove ambiguous classified sequences from DHF files
   seqwords     Generates DHF files from keyword search of UniProt
   siggen       Generates a sparse protein signature from an alignment
   siggenlig    Generate ligand-binding signatures from a CON file
   sigscan      Generate hits (DHF file) from a signature search
   sigscanlig   Search ligand-signature library & write hits (LHF file)

12.0 DIAGNOSTIC ERROR MESSAGES

   The log file might contain the following messages:
   Could not open seed sequence file my.file (file read error on input
   sequence alignment or sequence file)
   Empty alignment in my.file (input alignment was empty.)
   Empty singlet sequence for my.file (singlet sequence file was empty.)
   Could not open domain hits file my.file (file read error on input
   sequence file.)
   Not enough sequences found in domain hits file (insufficient sequences
   (i.e. < 2) in input sequence file.)

13.0 AUTHORS

   Ranjeeva Ranasinghe (rranasin@rfcgr.mrc.ac.uk)
   Jon Ison (jison@rfcgr.mrc.ac.uk)
   MRC Rosalind Franklin Centre for Genomics Research Wellcome Trust
   Genome Campus, Hinxton, Cambridge, CB10 1SB, UK

14.0 REFERENCES

   Please cite the authors and EMBOSS.
   Rice P, Longden I and Bleasby A (2000) "EMBOSS - The European
   Molecular Biology Open Software Suite" Trends in Genetics, 15:276-278.
   
   See also http://emboss.sourceforge.net/

  14.1 Other useful references
