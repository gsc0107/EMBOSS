
                                  dbiflat 
                                      
   
   
Function

   Index a flat file database
   
Description

   dbiflat indexes a flat file database of one or more files, and builds
   EMBL CD-ROM format index files. This format is used by the software on
   the EMBL database CD-ROM distribution and by the Staden package in
   addition to EMBOSS, and appears to be the most generally used and
   publicly available index file format for these databases.
   
   A flat file database is a database in one of the native formats: EMBL,
   Swiss-Prot or GenBank, as distributed by the EBI, NCBI, or DDBJ. (It
   is called a 'flat' file to distinguish it from the complex relational
   database formats that this data is held in before being written to
   files and distributed.)
   
   Having created the EMBOSS indices for this file, a database can then
   be defined in the file emboss.defaults as something like:
   
DB emrod [
   type: N
   format: embl
   method: emblcd
   directory: /data/embl
]

Usage

   Here is a sample session with dbiflat
   

% dbiflat 
Index a flat file database
      EMBL : EMBL
     SWISS : Swiss-Prot, SpTrEMBL, TrEMBLnew
        GB : Genbank, DDBJ
    REFSEQ : Refseq
Entry format [SWISS]: EMBL
Database directory [.]: ../../embl
Wildcard database filename [*.dat]: rod.dat
Database name: EMBL
Release number [0.0]: 
Index date [00/00/00]: 
   
   Go to the output files for this example
   
Command line arguments

   Mandatory qualifiers:
   -idformat           menu       Entry format
   -directory          string     Database directory
   -filenames          string     Wildcard database filename
  [-dbname]            string     Database name
   -release            string     Release number
   -date               string     Index date

   Optional qualifiers: (none)
   Advanced qualifiers:
   -fields             menu       Index fields
   -exclude            string     wildcard filename(s) to exclude
   -indexdirectory     string     Index directory
   -maxindex           integer    Maximum index length
   -sortoptions        string     Sort options, typically '-T .' to use
                                  current directory for work files and '-k
                                  1,1' to force GNU sort to use the first
                                  field
   -[no]systemsort     boolean    Use system sort utility
   -[no]cleanup        boolean    Clean up temporary files

   General qualifiers:
  -help                boolean    Report command line options. More
                                  information on associated and general
                                  qualifiers can be found with -help -verbose
   

   Mandatory qualifiers Allowed values Default
   -idformat Entry format
   EMBL   (EMBL)
   SWISS  (Swiss-Prot, SpTrEMBL, TrEMBLnew)
   GB     (Genbank, DDBJ)
   REFSEQ (Refseq)
   SWISS
   -directory Database directory Any string is accepted .
   -filenames Wildcard database filename Any string is accepted *.dat
   [-dbname]
   (Parameter 1) Database name A string from 1 to 19 characters Required
   -release Release number A string up to 9 characters 0.0
   -date Index date Date string dd/mm/yy 00/00/00
   Optional qualifiers Allowed values Default
   (none)
   Advanced qualifiers Allowed values Default
   -fields Index fields
   acnum   (Accession number)
   seqvn   (Sequence Version and GI)
   des     (Description)
   keyword (Keywords)
   taxon   (Taxonomy)
   acnum
   -exclude wildcard filename(s) to exclude Any string is accepted An
   empty string is accepted
   -indexdirectory Index directory Any string is accepted .
   -maxindex Maximum index length Integer 0 or more 0
   -sortoptions Sort options, typically '-T .' to use current directory
   for work files and '-k 1,1' to force GNU sort to use the first field
   Any string is accepted -T . -k 1,1
   -[no]systemsort Use system sort utility Boolean value Yes/No Yes
   -[no]cleanup Clean up temporary files Boolean value Yes/No Yes
   
Input file format

   'flat' files (native distribution format) of a protein or nucleic
   sequence database.
   
Output file format

  Output files for usage example
  
  File: acnum.hit
  
   This file contains non-printing characters and so cannot be displayed
   here.
   
  File: acnum.trg
  
   This file contains non-printing characters and so cannot be displayed
   here.
   
  File: division.lkp
  
   This file contains non-printing characters and so cannot be displayed
   here.
   
  File: entrynam.idx
  
   This file contains non-printing characters and so cannot be displayed
   here.
   
   dbiflat creates four index files. All are binary but with a simple
   format.
     * division.lkp is the master index file, and has a 300 byte header
       containing the database name and date plus information on the
       record size. This header is followed by one record for each
       database file, giving the full file name for the data file, and
       optionally a second sequence file.
     * entryname.idx is the entry name index. It has the same 300 byte
       header, mainly used to store the record size which will depend on
       the size of the longest entryname in the database. Each entry is
       stored in sorted alphanumeric order so that a binary search can be
       used to efficiently find any record. The record also holds the
       file number from division.lkp and the offsets in the data and
       sequence files for that entry.
     * acnum.trg holds the accession number information. The file has the
       usual 300 byte header, and a sorted list of record by accession
       number. Each accession number record contains the first record
       number in acnum.hit and the total number of records in acnum.hit
       so that secondary (duplicated) accession numbers can be searched.
     * acnum.hit is a very simple file. After the usual 300 byte header,
       each record simply holds the record number in entryname.idx. An
       accession number search will use acnum.trg to find a start
       position and number of records to read in this file, and will then
       simply read the entryname.idx records for each entry in turn.
       
Data files

   None.
   
Notes

   The indexing method depends on each entry having a unique entry name.
   No allowance is made for two entries with the same name so it is not
   possible to index EMBL and EMBLNEW together.
   
References

   None.
   
Warnings

   None.
   
Diagnostic Error Messages

   None.
   
Exit status

   It exits with a status of 0 if no problems.
   
Known bugs

   None.
   
See also

   Program name          Description
   dbiblast     Index a BLAST database
   dbifasta     Index a fasta database
   dbigcg       Index a GCG formatted database
   
Author(s)

   This application was written by Peter Rice (pmr@ebi.ac.uk) Informatics
   Division, The EBI, Wellcome Trust Genome Campus, Hinxton, Cambridge,
   CB10 1SA, UK.
   
History

   Completed December 1999
   
   Date Editor Comment
   2000/09/19 ajb ACD file: First ever bioperl cvs for emboss
   2000/09/19 ajb ACD file: branches: 1.1.1;
   2000/09/19 ajb Program: First ever bioperl cvs for emboss
   2000/09/19 ajb Program: branches: 1.1.1;
   2000/10/04 ajb Program: Fixed genbank index positions
   2000/10/14 ajb ACD file: Senger format inconsistencies
   2001/02/10 ajb Program: ajint mods
   2001/02/15 ajb Program: main line alterations
   2001/04/27 rice Program: DBI functions to embdbi.c
   2001/04/27 rice Program: ajint for int in doc headers
   2001/04/27 rice Program: more DBI functions moved to embdbi.c
   2001/05/10 gwilliam ACD file: groups changed
   2001/06/01 rice Program: embDbiFileList fix
   2001/06/04 rice Program: @prog headers generated from acd files
   2001/06/25 ajb Program: function rename
   2001/07/11 rice Program: (assumed) insignificant correction to ac
   index offset for first record
   2001/07/12 ajb Program: Memory leak fixes
   2001/10/29 ajb ACD file: acdpretty version
   2002/02/04 rice ACD file: remove dbknown (it was not being used
   anyway) for making sections
   2002/02/13 rice ACD file: ACD section and endsection added by Thomas
   Laurent
   2002/02/20 timc ACD file: gui/batch/cpu
   2002/02/25 rice Program: remove whitespace from database name
   2002/05/07 rice ACD file: new index fields, maxindex length, no
   -staden
   2002/05/07 rice Program: DBI programs use embDbi functions, generate
   new indices des,seqvn,keyword,taxon. Index token lengths.
   2002/05/12 ajb Program: Uninitialised variable
   2002/05/13 ajb Program: Added underscore to wordexps
   2002/08/06 rice Program: function docs update
   2002/08/22 rice Program: cleanup spaces, long lines, and header
   comments
   2002/08/28 rice Program: duplicate IDs reduce size of entrynam file,
   and fatal for in-memory sort
   2002/08/29 rice ACD file: refseq format
   2002/08/29 rice Program: @datastatic definitions for typedef structs
   
Target users

   This program is intended to be used by administrators responsible for
   software and database installation and maintenance.
   
Comments
